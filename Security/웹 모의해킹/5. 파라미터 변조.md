## I. 파라미터 변조 개요
#### 취약점 개요
URL로 전달되는 파라미터 변조를 통해 타인의 게시물을 열람, 수정 또는 타인의 인사, 회계 정보를 열람하거나 파라미터를 조작하여 권한을 상승하여 제한된 서비스 이용이 가능한 취약점  
공격자는 프록시로 패킷을 훔치고 변조된 요청값을 서버에 전송하는 방식으로 공격

#### 발생 원인
- 사용자로부터 전달받는 파라미터를 서버가 항상 신뢰하는 경우
- 서버로 유입되는 파라미터에 대한 일정한 기준으로 재검증하는 과정이 없는 경우
- 인증정보와 같은 데이터가 클라이언트 측에 저장되어 공격자가 조작 가능한 경우

### 개인정보 조회 - 정상
1. 사용자 로그인 시도
2. 웹서버는 데이터베이스와 통신하여 
해당 계정에 부여된 'UserNum'값으로 쿠키 생성 및 권한 인증 식별자로 사용
공격자는 프록시 도구로 사용하여 자신의 'UserNum'값을 타인의 번호로 변조
서버가 점검하지 않으면 

<br>

## II. 파라미터 변조 영향
### 권한 상승 예시
#### 권한 상승
회웑 어보 수정시 Hidden Field

### 타인 게시글 삭제
자신의 게시글 샂게 시 발생하는 요청해서 글 번호를 임

<br>

## III. 불충분한 이용자 인증
### 개요
#### 취약점 개요
타 사용자의 인증 정보를 악용할 수 있거나 사용자 인증 로직을 우회할 수 있는 취약점

#### 식별 / 인증 / 인가
- 식별 : 사용자가 자신의 신원정보를 밝히고 확인하는 행위
- 인증 : 신원정보/신원확인의 유효성 확립
- 인가 : 사용자에게 자원에 대한 접근을 허락하거나, 어떤 수준의 권한과 서비스를 부여(허용)

#### 점검 방법 및 기준
- 사용자 인증 미비 : 로그인 이후 접근 가능한 페이지에 대해 로그인 없이 URL 직접 접근으로 접근이 가능한지 여부를 점검
    - 로그인 세션에 대한 인증 모듈이 누락된 경우
    - 로그인 세션에 대한 인증이 있으나 우회가 가능하 ㄴ경우 "불충분한 이용자 인가"로 분류
- 인증 정보 제사용 : 암호화된 인증 정보(인증 토큰, 암호화된 패스워드)의 random성 및 재사용 가능성으르 테스트
    - 암호화된 인증정보 String이 매 인증시마다 동일할 경우 취약
    - 인증정보 String이 매번 변경될 경우에도, 과거 사용되었던 인증 정보 String을 재사용하는 경우
- SSO 인증 모듈 안정성
    - SSO 적용된 사이트 집합에서 특정 사이트에서 타 사이트로 전환하는 과정에서 인증 정보의 변조를 통한 계정 도용이 가능한지 점검
    - SSO : 통합로그인
- 공인인증서 모듈 안정성
    - 인증서 정보 재사용 가능 여부 테스트 : 인증서 전송 request에서 cer
    - 서버 측의 인증서 정상 검증 여부 테스트
    - 인증서 로그인 과정에서 노출되는 ID parameter 등 변조 가능성 테스트

### 보안 대책
#### 대응 방안
 - 사용자로부터 전송되어온 URL 파라미터, 쿠키 변수, 헤더, referer 등 모든 HTTP 코드는 항상 변조
 모든 요청을 검사해야 하고, 불필요한 데이터는 받지 않도록 해야 함
 - 만일 사용자로부터 전송된 값을 꼭 사용해야 한다면 반드시 이들 값의 변조 여부에 대한 유효성 검토를 거쳐야 함
 - 이 항목은 진단 대상의 구조 및 종류, 서비스 유형 등에 따라서 다양한 형태의 취약점이 발생하는 항목이므로 진단 시 각 진단대상의 특성에 맞게 커스터마이징 된 보안 대책을 사용해야 함

<br>

## IV. 불충분한 이용자 인가
### 개요
#### 취약점 개요 
- 권한이 없는 기능이나 페이지에서 파라미터 변조를 통해 권한을 획득하는 취약점
- 개인정보 조회, 민원정보 조회와 같이 개인정보를 다루는 페이지에 대해 적절한 검증이 되지 않아 불법 접근 및 조작이 가능
(ex. 파라미터에 user level)
- cf) 세션을 정확히 검증만 하면 공격 예방 가능

### 점검 방법 및 기준
- 사용자별 권한 관리 절차의 누락
- 타 사용자 정보의 무단 열람
- 게시판 권한 관리 취약점
    - 게시판 기능의 권한 관리 적절성 여부를 진단함
    - 대응방안 작성 시 보안대책 적용이 필요한 페이지를 명시함
- 중요 페이지 접근 시 재인증 실시
    - 중요 정보를 처리하는 페이지 접근 시 재인증을 실시하고 있는지 여부를 점검
    - 이 항목은 정책적 항목이므로 "권고사항"으로 처리
- 타 사용자 정보의 무단 변조
    - Request에서 정보 수정의 식별값으로 판단되는 파라미터가 존재할 경우, 해당 식별값을 변조하여 타 사용자의 정보를 수정 가능한지 확인함
    - 식별 값 파라미터를 변조하여 전송했을 때 정상적으로 정보 조회가 되는지 먼저 확인해야 함
- 로그인 모드(조회전용/이체) 임의 변경
    - 아이디/패스워드 로그인과 공인인증서 로그인의 기능이 구분되어 있는 사이트의 경우
- 인증 요소 생략 가능성
    - 다중 인증 요소를 요구하고 있는 작업 처리 시, 요구되는 인증 요소들 중 일부 요소의 생략/우회가 가능하지 여부를 점검
- 유료 컨텐츠의 무단 사용
- 다운로드 권한 관리 미비
    - 다운로드 URL에 인증/인가 모듈이 누락되었는지 여부에 대한 점검

### 보안 대책
#### 대응 방안
- 인증 후 접속할 수 있는 페이지의 경우 해당 페이지 주소를 직접 입력하거나 파라미터 변조를 통해 접속하지 못하도록 페이지 각각에 대하여 인증을 위한 세션 관리 필요
- 하나의 프로세스는 일반적으롱 ㅕ러 개의 페이지로 이루어지므로 접근 통제를 구현하고 있는 코드는 구조화 모듈화가 되어 있어야 퀀한 체크가 누락되는 것을 방지할 수 있음
- 인증 과정을 처리하는 부분에 클라이언트 사이드 스크립트를 사용하면 사용자가 임의로 수정할 수 있으므로 서버 사이드 스크립트를 통하여 인증 및 필터링 과정이 수행되어야 함
- 히든 필드에 저장된 값은 소스보기로확ㅇ니할 수 있으므로 중요 정보는 서버 측 세션을 사용하여 페이지 상에 노출되지 않도록 구현
- 불가피하게 사용 시 반드시 암호화하여 사용하고 서버측에서 검증 필요

<br>

## V. 프로세스 검증 누락
### 개요
공격자가 어플리케이션의 계획된 매커니즘을 우회하는 것이 가능한 취약점

### 점검 방법 및 기준
- 가격 변조 가능성
- 부가 금액 변조 가능성
- 인증 프로세스 취약점 (SMS 인증, 카드 인증, 계좌번호 인증, 이메일 인증 등)

### 보안 대책
다음의 우회될 수 있도록 플로우를 차단하여야 하며, 페이지 별 권한 매트릭스를 작성하여, 페이지에 부여된 권한의 타당성을 검증하여야 함