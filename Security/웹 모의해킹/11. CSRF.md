# CSRF
- Kali BeEF
- 다양한 ToolKit의 등장으로 위험성이 높아짐

### XSS와의 비교
- XSS의 경우 악성 스크립트로 cookie, keylogger, BeEF 등을 탈취해 개인에게 피해가 감
- CSRF는 요청을 변조해 서버의 정보를 수정해 서버에 피해를 줌
- CSRF는 요청이 다른 사이트에서 와도 된다는 전제가 깔려 있음

### 보안 대책
내가 아는 걸 모르게 하는 게 보안 대책
1. POST 사용 (X)
    - 대부분의 사이트는 form과 process 페이지가 나눠져 있음
    - 게시글에 process.jsp?id=hacker&level=10으로 스크립트 숨겨 놓음
    - POST로 전송하면 id, level을 body로 보냄
    - 이런 경우 공격 벡터가 줄어들긴 하지만 js로 전송 가능
2. referer (X)
    - 전 페이지가 어디인지 확인하는 헤더
    - 오픈 소스의 경우 로직을 알 수 있으므로 form을 호출하고 거기서 process를 호출하면 우회 가능
3. prompt(확인) (△)
    - form에서 확인함
    - confirm 파라미터 하나만 추가됨
    - 오픈 소스 같이 로직을 알고 있는 경우에만 가능
4. token (X)
    - 랜덤 값, 계속해서 바뀌는 값
    - 클라이언트 요청이 오면 서버에서 세션에 csrf_token=1234를 넣음
    - 서버에서 클라이언트에 응답을 보낼 때 토큰을 같이 보냄
    - 응답을 받아서 조작 가능(js를 이용해서)
5. XSS (X)
    - 내 사이트의 XSS는 막을 수 있어도 다른 사이트의 XSS는 막을 수 없다.
    - XSS와 토큰을 같이 하면 막을 수는 있지만 XSS를 모두 막는 것이 불가능함
    - 그럼에도 불구하고 XSS와 토큰을 같이 사용하면 양호
6. CAPTCHA (O)
    - 자동 제출 방지를 위해 만들어진 로직
7. 2차 인증
    - 추가적으로 비밀번호 요구

> CAPTCHA, 2차 인증의 경우 해커가 미리 예측할 수 없기 때문에 안전하다고 할 수 있음